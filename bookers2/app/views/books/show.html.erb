<%= render "books/list", user: @user, book: @book_new %>

<h2>Book detail</h2>
<table class="table">
  <tr id="book_<%= @book.id %>">
    <th>
      <%= link_to user_path(@book.user.id) do %>
      <%= attachment_image_tag @user, :profile_image, fallback: "no_image.png", size: "40x40" %>
      <br />
      <%= @book.user.name %>
      <% end %>
    </th>
    <th>
      <%= @book.title %>
    </th>
    <th>
      <%= @book.body %>
    </th>
    <th>

    </th>
    <% if @book.user.id == current_user.id %>
    <th><%= link_to "Edit", edit_book_path, class: "btn btn-sm btn-success" %></th>
    <th><%= link_to "Destroy", book_path(@book), method: :delete, class: "btn btn-sm btn-danger" %></th>
    <% end %>
    <th class="favorite_button">
      <%= render "favorites/favorite", book: @book %>
    </th>
    <th>
      <p>コメント数：<%= @book.book_comments.count%></p>
    </th>
  </tr>
</table>
<table>
  <% @book.book_comments.each do |book_comment| %>
    <% book_comment_user = book_comment.user %>
  <tr>
    <th>
      <%= link_to user_path(book_comment_user), class: "user_#{book_comment_user.id}" do %>
        <%= attachment_image_tag book_comment_user, :profile_image, :fill, 50, 50, fallback: "no_image.png", size: "40x40" %><br>
      	<%= book_comment_user.name %>
    	<% end %>
    </th>
    <th><%= book_comment.comment %></th>
    <% if current_user == book_comment_user %>
      <th>
        <%= link_to 'Destroy', book_book_comments_path(book_comment.book_id, book_comment.id), class: 'btn-sm btn-danger', method: :delete %>
      </th>
    	<% end %>
  </tr>
  <% end %>
</table>
<%= form_with model:[@book,@book_comment], local: true do |f| %>
  <%= f.text_area :comment, size:"80x7" %><br>
  <%= f.submit '送信'%>
<% end %>
